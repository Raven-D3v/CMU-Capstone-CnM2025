{% extends "base.html" %}
{% block title %}Callers List | OneTapSOS{% endblock %}

{% block content %}
<div class="p-6 space-y-6">
    <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-3">
        <h2 class="text-2xl font-semibold text-gray-800 text-glow">EMERGENCY CALLERS</h2>
        <p class="text-gray-600 text-sm md:text-base"><strong>{% now "l, F j, Y - h:i A" %}</strong></p>
    </div>

    {% if callers %}
    <!-- Desktop Table -->
    <div class="hidden md:block overflow-x-auto">
        <table class="w-full border-collapse bg-white shadow-md rounded-lg overflow-hidden">
            <thead>
                <tr class="bg-gray-100">
                    <th class="p-3 border-b text-left text-gray-800 font-semibold">User ID</th>
                    <th class="p-3 border-b text-left text-gray-800 font-semibold">Name</th>
                    <th class="p-3 border-b text-left text-gray-800 font-semibold">Phone Number</th>
                    <th class="p-3 border-b text-left text-gray-800 font-semibold">Email</th>
                    <th class="p-3 border-b text-left text-gray-800 font-semibold">Last Report ID</th>
                    <th class="p-3 border-b text-left text-gray-800 font-semibold">Classification</th>
                    <th class="p-3 border-b text-left text-gray-800 font-semibold">Sent</th>
                    <th class="p-3 border-b text-left text-gray-800 font-semibold">Location</th>
                    <th class="p-3 border-b text-left text-gray-800 font-semibold">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for caller in callers %}
                <tr class="hover:bg-gray-50">
                    <td class="p-3 border-b">{{ caller.caller_id }}</td>
                    <td class="p-3 border-b">{{ caller.full_name|default:"N/A" }}</td>
                    <td class="p-3 border-b">{{ caller.phone_number }}</td>
                    <td class="p-3 border-b">{{ caller.email|default:"N/A" }}</td>
                    <td class="p-3 border-b">{{ caller.last_report_id|default:"N/A" }}</td>
                    <td class="p-3 border-b">{{ caller.last_report_category|default:"N/A" }}</td>
                    <td class="p-3 border-b">{{ caller.last_report_date|date:"M d, Y H:i"|default:"--" }}</td>
                    <td class="p-3 border-b">{{ caller.last_report_location|default:"N/A" }}</td>
                    <td class="p-3 border-b text-center">
                        <a href="{% url 'callers_view' caller.caller_id %}" class="inline-block px-4 py-1 bg-[#4B7289] text-white rounded hover:bg-[#6B7280] transition border-glow">VIEW</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Mobile Cards -->
    <div class="space-y-4 md:hidden">
        {% for caller in callers %}
        <div class="bg-white shadow-md rounded-lg p-4 border border-gray-200">
            <p class="text-sm"><span class="font-semibold text-gray-700">User ID:</span> {{ caller.caller_id }}</p>
            <p class="text-sm"><span class="font-semibold text-gray-700">Name:</span> {{ caller.full_name|default:"N/A" }}</p>
            <p class="text-sm"><span class="font-semibold text-gray-700">Phone:</span> {{ caller.phone_number }}</p>
            <p class="text-sm"><span class="font-semibold text-gray-700">Email:</span> {{ caller.email|default:"N/A" }}</p>
            <p class="text-sm"><span class="font-semibold text-gray-700">Last Report ID:</span> {{ caller.last_report_id|default:"N/A" }}</p>
            <p class="text-sm"><span class="font-semibold text-gray-700">Classification:</span> {{ caller.last_report_category|default:"N/A" }}</p>
            <p class="text-sm"><span class="font-semibold text-gray-700">Sent:</span> {{ caller.last_report_date|date:"M d, Y H:i"|default:"--" }}</p>
            <p class="text-sm"><span class="font-semibold text-gray-700">Location:</span> {{ caller.last_report_location|default:"N/A" }}</p>
            
            <div class="mt-3 text-right">
                <a href="{% url 'callers_view' caller.caller_id %}" class="px-4 py-1 bg-[#4B7289] text-white rounded hover:bg-[#6B7280] transition border-glow">VIEW</a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="text-gray-500">No callers found.</p>
    {% endif %}
</div>
{% endblock %}
